# ご当地観光マップ ─ 松江市温泉マップ版 要件定義書

---

## 0. 開発フロー（全体像）

| フェーズ                           | 目的                         | 主なアウトプット                             |
| ---------------------------------- | ---------------------------- | -------------------------------------------- |
| 0. キックオフ & ゴール定義         | ステークホルダーの合意形成   | プロジェクトゴール / 成功指標（KPI）         |
| 1. 要件定義                        | **何を作るか** を確定        | **要件定義書 ★**                             |
| 2. 情報設計・UI/UX 設計            | 使いやすさと再利用性を設計   | 画面遷移図・ワイヤーフレーム・UX 原則        |
| 3. システムアーキテクチャ設計      | 技術選定と構成を固める       | コンポーネント図・ER 図・API 仕様（OpenAPI） |
| 4. 開発環境構築 & CI/CD            | Vercel / GitHub Actions 設定 | IaC ファイル・CI/CD パイプライン             |
| 5. コンポーネント開発 & 単体テスト | React / Next.js 実装         | 各コンポーネント・Jest/RTL テスト            |
| 6. 結合・E2E テスト                | 機能統合と回帰確認           | Playwright シナリオ・テストレポート          |
| 7. リリース準備 & 本番デプロイ     | 本番環境の品質保証           | リリースノート・監視設定                     |
| 8. 運用 & 継続的改善               | フィードバックループ         | ロードマップ更新・A/B テスト結果             |

---

## 1. 背景・目的

### 背景

- 松江市周辺の温泉情報が分散し、観光客が比較しづらい
- 地元レビューや広告収益化の導線が未整備

### 目的

1. **温泉選びをシームレスにし、来訪・消費を促進**
2. 地元レビューや広告を通じた **地域経済活性化**
3. テンプレート化したデザインで **別テーマ（グルメ・史跡など）へ水平展開**

---

## 2. ステークホルダー

| 役割                 | 主な関心事                                       |
| -------------------- | ------------------------------------------------ |
| 観光客（訪問ユーザ） | 分かりやすい比較・信頼できるレビュー・スマホ対応 |
| 地元住民（レビュア） | 投稿しやすさ・承認の速さ                         |
| 温泉事業者           | 広告出稿・施設情報更新                           |
| 管理者（運営）       | CMS・ユーザ管理・テーマ展開コスト                |
| 開発チーム           | 再利用性・デプロイ簡便・拡張性                   |

---

## 3. ゴール指標（KPI 例）

- **MAU**：3,000 人以上（リリース半年以内）
- **レビュー投稿率**：5%以上
- **ページ表示速度（LCP）**：モバイル ≤ 2.5 秒

---

## 4. ユースケース概要

### 観光客

- 地図／リストで温泉を閲覧し詳細を確認
- レビュー・評価を参考に訪問計画

### 地元住民

- ログイン後、温泉に ★ 評価＋コメント投稿

### 温泉事業者

- 管理画面から広告バナー登録・掲載期間設定

### 管理者

- コンテンツ新規テーマ作成（コピー＋カスタマイズ）
- ユーザ・レビュー・広告の承認／削除

---

## 5. 機能要件

| 番号  | カテゴリ            | 必須 / 任意  | 概要                                     |
| ----- | ------------------- | ------------ | ---------------------------------------- |
| FR-01 | 温泉一覧表示        | 必須         | 地図（Google Maps API）＋カード型リスト  |
| FR-02 | 温泉詳細ページ      | 必須         | 施設情報・画像・レビュー表示             |
| FR-03 | レビュー投稿        | 必須         | ★1–5・コメント・画像添付（1 枚）         |
| FR-04 | 広告管理            | 必須         | バナー CRUD・掲載位置設定                |
| FR-05 | テーマ複製          | 必須         | 既存マップをテンプレ化して別テーマへ複製 |
| FR-06 | CMS（スポット管理） | 必須         | CRUD + CSV 一括インポート                |
| FR-07 | 認証 / ユーザ管理   | 必須         | Email/Password + OAuth（Google / Apple） |
| FR-08 | レスポンシブ対応    | 必須         | モバイル・タブレット・PC 対応            |
| FR-09 | 多言語対応          | 任意（次期） | ja / en 切替                             |
| FR-10 | SEO 最適化          | 必須         | Structured Data・OG タグ自動生成         |

---

## 6. 非機能要件

- **パフォーマンス**：モバイル LCP ≤ 2.5 秒（P75）
- **スケーラビリティ**：Vercel Edge Functions & ISR 利用
- **セキュリティ**：OWASP Top10 対策、JWT + Supabase RBAC
- **拡張性**：Atomic Design + Storybook 採用
- **運用**：GitHub Actions → Vercel Preview / Production 自動化
- **可観測性**：Sentry・Vercel Analytics・Log Drain

---

## 7. データモデル（ハイレベル）

```sql
-- PostgreSQL
User     { id, name, email, role }
Onsen    { id, name, geo_lat, geo_lng, description, tags[], images[] }
Review   { id, onsen_id, user_id, rating, comment, created_at }
AdBanner { id, image_url, link_url, start_at, end_at, placement }
Theme    { id, name, slug, primary_color, assets JSONB }
```

---

## 8. 外部インテグレーション

| サービス             | 用途                                         |
| -------------------- | -------------------------------------------- |
| Google Maps Platform | 地図描画・Places API（座標・写真）           |
| Supabase             | DB(Postgres)・Auth・Storage・Edge Fn         |
| Vercel               | フロント/API デプロイ・Serverless・Analytics |
| （将来）Stripe       | 広告課金の決済基盤                           |

---

## 9. 画面一覧（次フェーズ詳細化）

- トップ / 温泉マップ
- 温泉詳細
- レビュー投稿モーダル
- 広告バナー領域（共通レイアウト）
- 管理ダッシュボード
- テーマ管理画面

---

## 10. 制約・前提

1. 地図 API キーは運営側で用意
2. 広告収益モデルは **固定額 / 期間課金**（クリック課金は次期対応）
3. UI デザイン指針：**Tailwind CSS + shadcn/ui**
4. OSS ライセンスは **MIT / Apache 2.0** 優先

---

## 11. リスクと対策

| リスク                       | 影響         | 対策                                        |
| ---------------------------- | ------------ | ------------------------------------------- |
| Google Maps API コスト増     | OPEX 上昇    | キャッシュ＋静的タイル生成                  |
| レビュー荒らし               | UX 悪化      | 通報＋モデレーションワークフロー            |
| テーマ複製時のレイアウト破綻 | 再利用性低下 | Storybook + Playwright ビジュアル回帰テスト |

---

## 12. 概算スケジュール

| 期間   | フェーズ              | マイルストーン                   |
| ------ | --------------------- | -------------------------------- |
| W1–2   | 要件定義              | 本ドキュメント承認               |
| W3–4   | UI/UX 設計            | 画面遷移図・ワイヤーフレーム完成 |
| W5–6   | アーキテクチャ設計    | ER 図・API 仕様 Fix              |
| W7–10  | 実装 ① コア機能       | 温泉閲覧・CMS                    |
| W11–12 | 実装 ② レビュー・広告 | 投稿・バナー管理                 |
| W13    | テスト                | 全 E2E パス                      |
| W14    | 本番公開              | Vercel Production                |

---

## 13. 次アクション

1. **ステークホルダー確認会議を設定**し、本要件定義書の承認を取得
2. 承認後、フェーズ 2「**UI/UX 設計**（画面遷移図・ワイヤーフレーム）」へ移行
3. 本ドキュメントは **Single Source of Truth** として Git で管理
